# ğŸ† **íŒ€ëª…: ìƒí˜¸ë“¤** ğŸ†

| <img src="https://lh3.googleusercontent.com/a-/ALV-UjVorSzGodCrmHOqo72yEiWywzdzetN0vFYGzbYMAZEjW8lT3zSDjg=s100-p-k-rw-no" width="195" height="195"/> | <img src="https://lh3.googleusercontent.com/a-/ALV-UjVorSzGodCrmHOqo72yEiWywzdzetN0vFYGzbYMAZEjW8lT3zSDjg=s100-p-k-rw-no" width="195" height="195"/> | <img src="https://lh3.googleusercontent.com/a-/ALV-UjVorSzGodCrmHOqo72yEiWywzdzetN0vFYGzbYMAZEjW8lT3zSDjg=s100-p-k-rw-no" width="195" height="195"/> | <img src="https://lh3.googleusercontent.com/a-/ALV-UjVorSzGodCrmHOqo72yEiWywzdzetN0vFYGzbYMAZEjW8lT3zSDjg=s100-p-k-rw-no" width="195" height="195"/> | <img src="https://lh3.googleusercontent.com/a-/ALV-UjVorSzGodCrmHOqo72yEiWywzdzetN0vFYGzbYMAZEjW8lT3zSDjg=s100-p-k-rw-no" width="195" height="195"/> |
|:-------------------------------------:|:-------------------------------------:|:-------------------------------------:|:-------------------------------------:|:-------------------------------------:|
|  **ì•ˆíƒœì˜**                         |  **í™©í˜¸ì¤€**                         |  **í—ˆìƒí˜¸**                         |  **ë°•ì´ˆì—°**                         |  **ì¥ì •í˜¸**                         |
| **Langchain & RAG<br>Prompt Engineering** | **Langchain & RAG<br>streamlit**                   | **Preprocessing<br>Langchain & RAG**          | **Preprocessing<br>streamlit**                   | **Preprocessing<br>README**               |
<br>

# ğŸš— ìš´ì „ì ë³´í—˜ ì•½ê´€ ì§ˆì˜ì‘ë‹µ ì±—ë´‡
## ğŸ“Œ í”„ë¡œì íŠ¸ ì†Œê°œ
ìš´ì „ì ë³´í—˜ ì•½ê´€ì„ ë³´ë‹¤ ì‰½ê²Œ ì´í•´í•˜ê³  í™œìš©í•  ìˆ˜ ìˆë„ë¡ ì„¤ê³„ëœ ì§ˆì˜ì‘ë‹µ ì‹œìŠ¤í…œì…ë‹ˆë‹¤. ì´ í”„ë¡œì íŠ¸ëŠ” ë‚´ì™¸ë¶€ ë¬¸ì„œë¥¼ íš¨ìœ¨ì ìœ¼ë¡œ ì²˜ë¦¬í•˜ê³ , ì‚¬ìš©ìê°€ ì›í•˜ëŠ” ì •ë³´ë¥¼ ì‹ ì†í•˜ê²Œ ì œê³µí•˜ëŠ” ë° ì´ˆì ì„ ë§ì¶”ê³  ìˆìŠµë‹ˆë‹¤.
RAG(Retrieval-Augmented Generation) ë°©ì‹ì„ í™œìš©í•˜ì—¬, LangChainê³¼ Chroma ë°ì´í„°ë² ì´ìŠ¤ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì „ë¬¸ ë¬¸ì„œì˜ ì‹ ë¢°ë„ ë†’ì€ ë‹µë³€ì„ ìƒì„±í•©ë‹ˆë‹¤.

## ğŸ“Œ í”„ë¡œì íŠ¸ ë™ê¸°
ë³µì¡í•œ ë³´í—˜ ì•½ê´€ì˜ ì •ë³´ë¥¼ ì¼ë°˜ ì‚¬ìš©ìë‚˜ ìƒë‹´ì›ì´ ì‰½ê²Œ ì¡°íšŒí•  ìˆ˜ ìˆë„ë¡ ë•ëŠ” ê²ƒì´ ëª©í‘œì…ë‹ˆë‹¤.<br>
ê¸°ì¡´ LLM ëª¨ë¸ì´ ì œê³µí•˜ëŠ” ì¼ë°˜ì ì¸ ë‹µë³€ì„ ë³´ì™„í•˜ê¸° ìœ„í•´ RAG ê¸°ìˆ ì„ ë„ì…í•˜ì—¬ ì‹¤ì§ˆì ì´ê³  êµ¬ì²´ì ì¸ ë‹µë³€ì„ ìƒì„±í•©ë‹ˆë‹¤.

## ğŸ“Œ ê¸°ëŠ¥
- ë¬¸ì„œ ì¸ë±ì‹±:
ìš´ì „ì ë³´í—˜ ì•½ê´€ ë°ì´í„°ë¥¼ 'jhgan/ko-sroberta-multitask'ëª¨ë¸ì´ìš©í•˜ì—¬ ë²¡í„°í™”í•œ ë¬¸ì¥ì„ ì €ì¥.
- RAG ê¸°ë°˜ ê²€ìƒ‰:
Chroma DBì—ì„œ ì‚¬ìš©ìì˜ ì§ˆë¬¸ê³¼ ìœ ì‚¬í•œ ë¬¸ì„œë¥¼ ê²€ìƒ‰.
- ì§ˆì˜ì‘ë‹µ ìƒì„±:
GPT-4o-mini ëª¨ë¸ì„ í™œìš©í•˜ì—¬ ê²€ìƒ‰ëœ ë¬¸ì„œë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë‹µë³€ ìƒì„±.
- ì •í™•í•œ ì •ë³´ ì œê³µ:
í• ë£¨ì‹œë„¤ì´ì…˜(ì˜ëª»ëœ ì •ë³´ ìƒì„±)ì„ ìµœì†Œí™”í•˜ê³  ì‹ ë¢°ë„ ë†’ì€ ë‹µë³€ ì œê³µ.

## ğŸ”¨ ê¸°ìˆ  ìŠ¤íƒ
<div>
<img src="https://img.shields.io/badge/python-3776AB?style=for-the-badge&logo=python&logoColor=white">
<img src="https://img.shields.io/badge/langchain-F7DF1E?style=for-the-badge&logo=langchain&logoColor=black">
<img src="https://img.shields.io/badge/openai-0769AD?style=for-the-badge&logo=openai&logoColor=black">
<img src="https://img.shields.io/badge/huggingface-FFD21E?style=for-the-badge&logo=huggingface&logoColor=white">
<img src="https://img.shields.io/badge/streamlit%20-%23FF0000.svg?style=for-the-badge&logo=streamlit&logoColor=white">
<img src="https://img.shields.io/badge/git-F05032?style=for-the-badge&logo=git&logoColor=white">
<img src="https://github.com/user-attachments/assets/c8cd01e7-6ce6-46db-8cc3-b13286829cf3" width="163" height="28"/>
</div>

## ğŸ“Œ System Architecture
![Architecture](./images/architecture.png)

## ğŸ“Œ ì½”ë“œë¦¬ë·°
ë°ì´í„° ë¡œë“œ ë° ì „ì²˜ë¦¬(PDF ì²˜ë¦¬ ë° ë²¡í„° ìŠ¤í† ì–´ ìƒì„±)
---
```python
def load_and_split_pdf(path_ins, chunk_size=1000, chunk_overlap=200):
  ---(ìƒëµ)
  return chunks

path_ins = r"C:\Users\USER\Desktop\pjt3\kb_driver_insurance.pdf"
chunks = load_and_split_pdf(path_ins)
```
| ![codeimage](./images/vscode.png) | ![pdfimage](./images/kb.png) |
|:-------------------------------------:|:-------------------------------------:|

PDFíŒŒì¼ì„ ë¡œë“œí•˜ê³  í…ìŠ¤íŠ¸ë¥¼ ì¤„, ê³µë°±ìœ¼ë¡œ êµ¬ë¶„í•˜ì—¬ ì²­í¬ë¡œ ë‚˜ëˆˆë‹¤.
 
```python
def process_pdf_to_vectorstore(vectorstore_name, chunks, embeddings):
    ---(ìƒëµ)
    return vector_store

embeddings = HuggingFaceEmbeddings(model_name="jhgan/ko-sroberta-multitask")
vector_store = process_pdf_to_vectorstore(vectorstore_name, chunks, embeddings)
```
ì‚¬ì „ í•™ìŠµëœ "jhgan/ko-sroberta-multitask"ëª¨ë¸ì„ ì‚¬ìš©í•˜ì—¬ í•œêµ­ì–´ ë¬¸ì¥ ì„ë² ë”©ì„ ìˆ˜í–‰í•œë‹¤.<br>
ë¹ ë¥´ê³  íš¨ìœ¨ì ì¸ ê²€ìƒ‰ì„ ìœ„í•´ ChromaDBë¥¼ ì´ìš©í•œ ë²¡í„°ìŠ¤í† ì–´ë¥¼ ìƒì„±í•œë‹¤.

RAG(Retrieval Augmented Generation) Chain ìƒì„±
---
```python
# ë²¡í„° ìŠ¤í† ì–´ ë¶ˆëŸ¬ì˜¤ê¸°
def load_vectorstore(vectorstore_name):
    return Chroma(persist_directory=f"./data/vector_stores/{vectorstore_name}")

# ë¦¬íŠ¸ë¦¬ë²„ ìƒì„±
def create_retriever(vector_store):
    # MMR: ë‚´ìš©ì˜ ì¤‘ë³µì„ ì¤„ì´ê³  ë‹¤ì–‘ì„±ì„ ì œê³µ, Similarity: ë‚´ìš©ì˜ ìœ ì‚¬ë„ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë‚´ìš©ì„ ê²€ìƒ‰
    return vector_store.as_retriever(search_type="similarity", search_kwargs={"k": 3})

# ëŒ€í™”í˜• ë¦¬íŠ¸ë¦¬ë²„ ì²´ì¸ ìƒì„±
def create_conversational_chain(llm, retriever):
    # ConversationalRetrievalChain ìƒì„±
    return ConversationalRetrievalChain.from_llm(llm, retriever)
```
![codeimage](./images/retrival2.png)

ì‚¬ìš©ì ì§ˆë¬¸ ì²˜ë¦¬ í•¨ìˆ˜(í”„ë¡¬í”„íŠ¸ ì—”ì§€ë‹ˆì–´ë§ ë“±)
---
```python
def generate_intelligent_prompt(user_input, retrieved_texts, mode="basic"):
    """
    ë¬¸ì„œ ë‚´ìš©ê³¼ ì§ˆë¬¸ì„ ê¸°ë°˜ìœ¼ë¡œ í”„ë¡¬í”„íŠ¸ë¥¼ ìƒì„±í•©ë‹ˆë‹¤.
    """
    if mode == "basic":
        return f"ì§ˆë¬¸: {user_input}\nìš´ì „ì ë³´í—˜ ê´€ë ¨ ë‹µë³€ì„ ì œê³µí•˜ì„¸ìš”."

    elif mode == "engineered":
        if not retrieved_texts:
            return (
                f"ë¬¸ì„œì— ê´€ë ¨ëœ ì •ë³´ê°€ ì—†ìŠµë‹ˆë‹¤. ì§ˆë¬¸ì— ëŒ€í•œ ë‹µë³€ì€ "
                f"'ê´€ë ¨ ë¬¸ì„œê°€ ì—†ìŠµë‹ˆë‹¤'ë¼ê³  ì œê³µí•´ì•¼ í•©ë‹ˆë‹¤."
            )
        context = "\n".join(retrieved_texts[:3])  # ìƒìœ„ 3ê°œì˜ ë¬¸ì„œ í…ìŠ¤íŠ¸
        return (
            f"ì•„ë˜ëŠ” ìš´ì „ì ë³´í—˜ê³¼ ê´€ë ¨ëœ ë¬¸ì„œì…ë‹ˆë‹¤. ë¬¸ì„œ ë‚´ìš©ì„ ë°˜ë“œì‹œ ê¸°ë°˜ìœ¼ë¡œ "
            f"ë‹µë³€ì„ ìƒì„±í•˜ì„¸ìš”. ë¬¸ì„œì— ì—†ëŠ” ë‚´ìš©ì— ëŒ€í•´ ìœ ì¶”í•˜ì§€ ë§ˆì„¸ìš”.\n\n"
            f"ë¬¸ì„œ ë‚´ìš©:\n{context}\n\n"
            f"ì§ˆë¬¸: {user_input}\n"
            f"ë‹µë³€:"
        )
    else:
        raise ValueError("Invalid mode. Choose 'basic' or 'engineered'.")
```

## ğŸ“Œ í• ë£¨ì‹œë„¤ì´ì…˜ í…ŒìŠ¤íŠ¸
| ![gpt4mini](./images/gpt4mini.png) | ![RAGgpt](./images/RAGgpt.png) |
|:-------------------------------------:|:-------------------------------------:|
| GPT-4o mini  | RAG GPT-4o mini |

![kbdocument](./images/kbdocument.png)<br>
RAG GPTëª¨ë¸ì˜ ê²½ìš° ë³¸ë¬¸ì˜ ë‚´ìš©ì—ì„œ ë‹µë³€ì„ ì¶”ì¶œí–ˆìŒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.

## ğŸ“Œ êµ¬í˜„í™”ë©´
![streamlit](./images/streamlit.png)
